<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Severus Snake</title>
        <link rel="shortcut icon" href="https://images.emojiterra.com/twitter/v13.0/128px/1f40d.png" type="image/png" />
        <meta name="description" content="Juego clasico de la vivorita" />
        <meta name="keywords" content="vivorita, nokia 1100, retro" />
        <meta name="author" content="Jeremias Figueroa" />
        <meta name="copyright" content="jereconjota 2021" />
        <!-- for spiders -->
        <meta name="robots" content="index follow" />
        <!-- for facebook link -->
        <meta property="og:title" content="Severus Snake" />
        <meta property="og:description" content="El clasico juego de la vivorita" />
        <meta property="og:type" content="website" />
        <meta property="og:image" content="https://images.emojiterra.com/twitter/v13.0/128px/1f40d.png" />
        <meta property="og:url" content="https://severus-snake.web.app/" />
        <!-- for twitter link -->
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:title" content="Severus Snake" />
        <meta name="twitter:description" content="El clasico juego de la vivorita" />
        <meta name="twitter:image" content="https://images.emojiterra.com/twitter/v13.0/128px/1f40d.png" />
        <meta name="twitter:url" content="https://severus-snake.web.app/" />
        <!-- Styles -->
        <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
        <style>
            body {
                background: #95a783;
                text-align: center;
                font-family: 'Press Start 2P', cursive;
                padding-top: 100px;
            }
            canvas {
                border: solid 10px #1b1c15;
                /* width: 500px; 
                height: 500px; */
            }
            .info {
                display: flex;
                justify-content: center;
                align-items: center;
                text-align: center;
                margin-bottom: 30px;
            }
            .info small p {
                width: 300px;
                text-align: center;
            }
            papel {
                display: flex;
                justify-content: center;
                align-items: center;
            }
            /* Smartphones (portrait and landscape) ----------- */
            @media only screen and (min-device-width: 320px) and (max-device-width: 480px) {
                canvas {
                    width: 350px;
                    height: 350px;
                }
                .info {
                    flex-direction: column;
                }
            }
        </style>
    </head>
    <body>
        <header>
            <div class="info">
                <small><p>Nombre: Jere</p></small>
                <small><p>Puntaje: 32541</p></small>
                <small><p>Record: 43152435</p></small>
            </div>
        </header>
        <section class="papel">
            <canvas width="500px" height="500px"></canvas>
        </section>
        <section class="controles">
            <div><button>↑</button></div>
            <div><button>←</button><button>→</button></div>
            <div><button>↓</button></div>
        </section>
        <script>
            const intervalo = 50;
            const direccion = {
                A: [-1, 0],
                D: [1, 0],
                S: [0, 1],
                W: [0, -1],
                a: [-1, 0],
                d: [1, 0],
                s: [0, 1],
                w: [0, -1],
                ArrowDown: [0, 1],
                ArrowUp: [0, -1],
                ArrowRight: [1, 0],
                ArrowLeft: [-1, 0],
            };
            let papel = document.querySelector('canvas');
            let contexto = papel.getContext('2d');
            let dondevoy;
            let controles = { direccion: { x: 1, y: 0 }, vivora: [{ x: 0, y: 0 }] };

            let looper = () => {
                console.log('looper');
                const sq = controles.vivora[0];
                let dx = controles.direccion.x;
                let dy = controles.direccion.y;
                sq.x += dx;
                sq.y += dy;
                requestAnimationFrame(dibujar);
                setTimeout(looper, intervalo);
            };

            document.onkeydown = (e) => {
                if(direccion.hasOwnProperty(e.key)){
                    haciaDonde(e.key);
                }
            };

            haciaDonde = (dir) => {
                const [x, y] = direccion[dir];
                if (-x !== controles.direccion.x && -y !== controles.direccion.y) {
                    controles.direccion.x = x;
                    controles.direccion.y = y;
                }
            }

            let dibujar = () => {
                if (screen.width <= 480) {
                    contexto.clearRect(0, 0, 350, 350);
                } else {
                    contexto.clearRect(0, 0, 500, 500);
                }
                contexto.fillStyle = 'black';
                const sq = controles.vivora[0];
                contexto.fillRect(sq.x*10, sq.y*10, 10, 10);
            };

            window.onload = () => {
                looper();
            };

        </script>
    </body>
</html>
